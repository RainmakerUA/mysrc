using System;
using RM.UzTicket.Lib.Utils;

namespace RM.UzTicket.Console.Tests
{
	internal static class JjDecoderTest
	{
		private static string _jjcode = @"$=~[];$={___:++$,$$$$:(![]+"""")[$],__$:++$,$_$_:(![]+"""")[$],_$_:++$,$_$$:({}+"""")[$],$$_$:($[$]+"""")[$],_$$:++$,$$$_:(!""""+"""")[$],$__:++$,$_$:++$,$$__:({}+"""")[$],$$_:++$,$$$:++$,$___:++$,$__$:++$};$.$_=($.$_=$+"""")[$.$_$]+($._$=$.$_[$.__$])+($.$$=($.$+"""")[$.__$])+((!$)+"""")[$._$$]+($.__=$.$_[$.$$_])+($.$=(!""""+"""")[$.__$])+($._=(!""""+"""")[$._$_])+$.$_[$.$_$]+$.__+$._$+$.$;$.$$=$.$+(!""""+"""")[$._$$]+$.__+$._+$.$+$.$$;$.$=($.___)[$.$_][$.$_];$.$($.$($.$$+""\""""+""\\""+$.__$+$.$$_+$.$$$+""\\""+$.__$+$.$_$+$.__$+""\\""+$.__$+$.$_$+$.$$_+$.$$_$+$._$+""\\""+$.__$+$.$$_+$.$$$+"".""+$.$_$_+(![]+"""")[$._$_]+$.$$$_+""\\""+$.__$+$.$$_+$._$_+$.__+""(\\\""\\""+$.__$+$.__$+$.___+$.$$$_+(![]+"""")[$._$_]+(![]+"""")[$._$_]+$._$+""\\""+$.$__+$.___+""\\""+$.__$+$._$_+$.___+""\\""+$.__$+$.$$_+$._$_+$._$+""\\""+$.__$+$.$__+$.$$$+""\\""+$.__$+$.$$_+$._$_+$.$_$_+""\\""+$.__$+$.$_$+$.$_$+""\\""+$.__$+$.$_$+$.$_$+$.$$$_+""\\""+$.__$+$.$$_+$._$_+""!\\\"");""+""\"""")())();";
		private static string _decoded = @"window.alert(""Hello Programmer!"");";

		public static void Run()
		{
			var decoded = JjDecoder.Decode(_jjcode);

			if (!_decoded.Equals(decoded, StringComparison.Ordinal))
			{
				throw new Exception($"JjDecoder test failed:\nExpected: '{_decoded}'\nActual: '{decoded}'");
			}
		}
	}
}
